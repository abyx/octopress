
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>The Code Dump</title>
  <meta name="author" content="Aviv Ben-Yosef">

  
  <meta name="description" content="Soon, I will be leaving my workplace for the past 3.5+ years, and that has got me to do some retrospective. One thing I&#8217;ve been reflecting on &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.codelord.net/page/8">
  <link href="/favicon.ico" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="http://feeds.feedburner.com/TheCodeDump" rel="alternate" title="The Code Dump" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-7925779-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">The Code Dump</a></h1>
  
    <h2>A place a coder rants at...</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="http://feeds.feedburner.com/TheCodeDump" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:www.codelord.net" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2009/04/04/sometimes-all-it-takes-is-a-little-push/">Sometimes all it takes is a little push</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-04-04T12:28:24+03:00" pubdate data-updated="true">Apr 4<span>th</span>, 2009</time>
        
         | <a href="/2009/04/04/sometimes-all-it-takes-is-a-little-push/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Soon, I will be leaving my workplace for the past 3.5+ years, and that has got me to do some retrospective. One thing I&#8217;ve been reflecting on is how good programmers seem to move towards better programming/working habits that are shown to them and how easy it can be sometimes to make a difference.</p>

<p>On August, I moved to a new team. At the time, the team consisted of 3 developers (including myself) and a team leader. Both other developers have joined the project about a year earlier than me, and have been working in the workplace about 2 years more. They are really talented folks, and I&#8217;ve learned quite a bit working with them. But when I joined the team, it was in a bit off a &#8220;stop&#8221;. The team didn&#8217;t have that feeling of self-propelling inertia.</p>

<p>I knew that they used to do scrum in order to manage tasks and work, but that had stopped for some reason, and in my first weeks there I noticed how task management was at fault - sending emails to one-another, with things getting lost between mail-clients and no real way to tell where we are currently standing.</p>

<p>After about 3 weeks in the team I showed the guys a few links of agile teams and their cool whiteboards, filled with tasks and burndown charts. They immediately liked it and said that &#8220;it does look cool&#8221;. A few days later I brought some stacks of post-it notes and we spent an hour deciding how to partition the board and a simple convention for the post-it notes and actually drawing it on a board with permanent markers. We used an ugly picture-frame (with the picture inside flipped, so the white side was facing the glass) to draw a burndown chart on.</p>

<p>It was an immediate success - every time someone walked in we all enjoyed explaining how the board works. Moving a task to done was usually followed by a bit of celebration and everyone could see what was going on easily. Now, 7 months later, we plan our sprints, have daily scrums and continue to get better at planning and being more agile.</p>

<p>What I&#8217;m trying to say is, I guess, that sometimes all it takes is just a little push in the right direction to start something good going on. It may take some balls or reading some <a href="http://www.amazon.com/gp/product/0671027034?ie=UTF8&amp;tag=thcodu02-20&amp;linkCode=as2&amp;camp=1789&amp;creative=9325&amp;creativeASIN=0671027034">Dale Carnegie</a><img src="http://www.assoc-amazon.com/e/ir?t=thcodu02-20&l=as2&o=1&a=0671027034" style="width: 0; height: 0; display: none; border: none !important;">, but it&#8217;s worth it!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2009/03/27/new-version-of-junitconverter-is-out/">New version of JUnitConverter is out</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-03-27T16:27:53+03:00" pubdate data-updated="true">Mar 27<span>th</span>, 2009</time>
        
         | <a href="/2009/03/27/new-version-of-junitconverter-is-out/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I just uploaded the latest version of <a href="http://junit-converter.sourceforge.net/">JUnitConverter</a> (yeah, I&#8217;m no big on design), and thought it would be the right chance to talk about it here.</p>

<p>In the summer of 2007 we, at my workplace, decided to upgrade our (non-legacy) code-bases to use JUnit 4 as part of a move to make people more aware of tests and like writing tests more.</p>

<p>I did some of the organizing work beforehand and saw that most of the migration work is dumb - delete that line, add an annotation there, etc. Not wanting people to get the feeling the that &#8220;testing is a dumb, routine, thing&#8221; I set out to write something to make things easier and more automated.</p>

<p>After some googling, I stumbled upon TestNG&#8217;s junit converter which converts junit tests to TestNG tests. Needing a fast solution, I hacked on its code to make it convert junit 3 tests to junit 4 tests and was done with it. The tool was used in our effort and helped (although it wasn&#8217;t perfect).</p>

<p>During the year and half that have passed since, I&#8217;ve continued working on junit-converter as a pet project. Wanting it to be smarter, and reduce the amount of needed work even more, I came to the conclusion that the smartest thing to do would be to use some Java parsing library (instead of using Doclet). I came across many different options, most of which lacking in strength or very cumbersome. Eventually, I decided using Antlr would be the best choice.</p>

<p>I developed JUC in my spare time, enjoying the different things I wanted to try out (it was done almost fully TDD with very high coverage, and I was always fascinated with antlr). Lately, I thought I&#8217;m not doing it justice by not updating the site (a large part is because sourceforge is so not welcoming in the admin mode), so I spent the last few hours tidying things up and creating a new release and uploaded it.</p>

<p>I think it&#8217;s a good tool for anyone who wants to upgrade his tests, but also can be a good place to see how working with Antlr and Java can be done. Actually, it&#8217;s one of the most interesting projects I&#8217;ve had the chance to hack with in the last few years.</p>

<p>Congratulations JUnitConverter!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2009/02/26/sending-sms-using-google-calendar-and-the-python-api/">Sending SMS using Google Calendar&#8217;s python API</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-02-26T23:37:51+02:00" pubdate data-updated="true">Feb 26<span>th</span>, 2009</time>
        
         | <a href="/2009/02/26/sending-sms-using-google-calendar-and-the-python-api/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Soon another semester will start. And, like every semester, I received the list of assignments that are due, with their deadlines. Up till now I used to type into Google Calendar each deadline and set SMS reminders, to make sure I won&#8217;t forget to hand the assignment, but this time I realized I&#8217;ve had enough of this, and don&#8217;t feel like entering 30 different tasks over and over again, set the sms reminders etc.</p>

<p>So I figured <em>&#8216;Google has an API for everything, why not automate it?&#8217;</em> So I opened their <a href="http://code.google.com/apis/calendar/docs/1.0/developers_guide_python.html">tutorial</a> and started reading. Just about all the information was there, other then information on setting a reminder&#8217;s type (pop up, sms, email etc&#8217;).</p>

<p>I&#8217;ve read the python API code, and couldn&#8217;t find a reference for this. Googling for it I saw a few people mentioning it and saying the easiest solution is setting the default reminder type to SMS and then using the samples in the tutorial.</p>

<p>After looking a little harder I saw the JavaScript API let&#8217;s one set this type (in the API it&#8217;s &#8216;method&#8217;), so I ran a javascript test and sniffed it just to make sure it&#8217;s a simple attribute. After seeing that is the case I came to the conclusion that all that&#8217;s needed to set the &#8216;method&#8217; of a reminder is this:</p>

<pre><code>reminder = gdata.calendar.Reminder(minutes='40')
reminder._attributes['method'] = 'method'
reminder.method = 'sms'
event.when[0].reminder.append(reminder)
</code></pre>

<p>Those two bold lines do the trick, where method can be &#8216;all&#8217;, &#8216;sms&#8217;, &#8216;email&#8217; and &#8216;alert&#8217; (meaning a pop-up).</p>

<p>Happy SMSing!</p>

<p>You should follow me on twitter <a href="http://twitter.com/avivby">here</a>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2008/08/15/how-to-pull-an-all-nighter/">How To Pull an All-Nighter</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-08-15T16:54:38+03:00" pubdate data-updated="true">Aug 15<span>th</span>, 2008</time>
        
         | <a href="/2008/08/15/how-to-pull-an-all-nighter/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Our team has recently received a brand new 50&#8217; plasma display. After some brainstorming we&#8217;ve decided we want to display on it a live dashboard that will be used for all sorts of stuff - an <a href="http://www.agileadvice.com/archives/2005/05/information_rad.html">information radiator</a> about current projects, displaying online information from production systems, pulling snapshots from different web-cams in our organization etc. Basically, we wanted to make it look <strong>Hot!</strong></p>

<p>We wrote down a lot of cool stuff that we would like to see there. One problem though - no one was going to let us spend a bunch of time working on it. So, we thought the best thing to do was to pull an all-nighter. This post summaries the preparation we have done in order to make it a successful one.</p>

<h4>Step 1: Decide what you want to do</h4>

<p>As I&#8217;ve already mentioned, we created a detailed lists of the different widgets we&#8217;d like to see on screen. We sketched the looks and the behaviour.</p>

<h4>Step 2: POC</h4>

<p>Because my team usually works on client-server systems and doesn&#8217;t do a lot of web programming and/or UI applications, we thought it would be best to do a Proof-of-Concept to everything that might prove to be harder to do than it seems.</p>

<p>Over the course of a week I wrote down simpler POCs that used the different APIs we wanted to use and that sort of stuff. I think that in general it took me less than 5 hours to create all of those.</p>

<h4>Step 3: Organize your environment</h4>

<p>A colleague and I created a simple installation of the required development environment in order to allow people to start coding as fast as possible.</p>

<h4>Step 4: Spread the knowledge</h4>

<p>At the beginning of the all-nighter I gave a 90 mins presentation of the technology involved. It was a simple walk-through of the basic kind of stuff that we were going to do. Later I sat down with each time and gave them a walk-through of the POC code that is relevant to their work.</p>

<h4>Step 5: Divide</h4>

<p>Before hand I sat down and divided all the work to tasks. Then I assigned pairs to the tasks keeping in mind that the pairing should be as good as possible (when you&#8217;ve got only one night you need to choose a pair that already works, as against to the usual where you can allow the pair some time to learn how to work together).</p>

<h4>Step 6: Conquer!</h4>

<p>Right after that we started coding like hell. I&#8217;ve set up a board full of Post-It notes of the different tasks at hand. The board was then divided into 3 parts: Backlog, In Progress and DONE. Moving a task to DONE was celebrated with a round of applause and everyone was able to see how we were doing by simply glancing at the board.</p>

<h4>Step 7: Enjoy the result</h4>

<p>At 6 AM we were finished. We had most of the dashboard ready and thought it was time to call it a night.</p>

<p>Some general tips:</p>

<ul>
<li>We collected some money and bought snacks and drinks for the whole night (not including the obligatory pizza, of course).</li>
<li>A colleague and I were responsible for integration - we spent the night between the working couples, seeing how they were doing, sharing information and tips that were being learned and made sure that people integrated their code as soon as possible. This was a good thing as gradually during the night the plasma screen became closer and closer to the result.</li>
<li>Make sure you&#8217;ve got good music.</li>
<li>Force everyone to take some breaks. We chatted a lot and some people played cards.</li>
<li>We set up a web cam that videoed the post-its board and the plasma display during the whole night. I haven&#8217;t had the chance to watch it yet, but I bet it&#8217;s going to be pretty cool watching it in fast-forward.</li>
</ul>


<p>I hope your all-nighter will be as fun as ours was!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2008/07/31/software-project-learning-process/">Software Project Learning Process</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-07-31T23:36:04+03:00" pubdate data-updated="true">Jul 31<span>st</span>, 2008</time>
        
         | <a href="/2008/07/31/software-project-learning-process/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Recently, a new guy has joined my team and is in the process of taking over one of the systems that&#8217;s currently in my control. The guy, as most of the other people in my workplace, is the product of the organization&#8217;s own &#8221;<a href="http://www.joelonsoftware.com/articles/ThePerilsofJavaSchools.html">Java School</a>&#8221; (&#8220;WHY?&#8221;, you&#8217;re yelling to yourself? That has to do with the special properties of my workplace, which can&#8217;t really be disclosed).</p>

<p>Anyway, I&#8217;ve tried to write down the points I think a person must control before being able to really lead a project, and would really like feedback on these.</p>

<p>Here it is, the Software Project Learning Process:</p>

<ul>
<li><p>Understand the project&#8217;s version control and release management - be able to check it out and build it.</p></li>
<li><p>Be able to sketch the flow of the system.</p></li>
<li><p><em>Read the code</em> of the main parts.</p></li>
<li><p>Run the tests. If you&#8217;re out of luck - find out exactly which ones are known not to pass and why.</p></li>
<li><p>Know how to deploy and run the project (especially relevant in legacy systems that are not changed often).</p></li>
<li><p>Meet your clients. If your project connects with others&#8217; (you receive input from Steve&#8217;s system, say), meet them too.</p></li>
<li><p>Know your project&#8217;s different input and output mediums (protocols with other systems, input file formats, etc).</p></li>
<li><p>Understand other resources in your project (special files used, the database scheme, etc).</p></li>
<li><p>Be able to tweak your project using its different configuration options.</p></li>
</ul>


<p>These are obviously not ordered by importance, as that varies between projects. I have found this list helpful in the last couple of years whenever I&#8217;ve had to get someone new up and running with one of our systems.</p>

<p>Cheers!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2008/07/09/dont-write-voodoo-code/">Don&#8217;t Write Voodoo Code!</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-07-09T19:27:20+03:00" pubdate data-updated="true">Jul 9<span>th</span>, 2008</time>
        
         | <a href="/2008/07/09/dont-write-voodoo-code/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Recently I started the process of handing one of my projects to a new programmer. The guy&#8217;s OK and has talent, but is very inexperienced and hasn&#8217;t had a chance to write real, production-quality code.</p>

<p>My general approach is usually talking about the purpose of the project, then architecture. Afterwards I talk about the purposes of the main parts in the design and then leave the guy to do a bit of digging.</p>

<p>Now, the time has come for the part that does <em>really</em> makes you understand what&#8217;s going on. I&#8217;ve given him a relatively small piece of work. How small? I guess it requires writing 4 new classes (2 plain objects and 2 real ones) that would take about 200 lines of code and modifying about 3 classes that already exist.</p>

<p>The guy started working on his solution when he asked me something to the lines of &#8220;which value should I return here? This one or that?&#8221; He was working with one of our tool-kit&#8217;s interfaces that I saw no reason for him to use. &#8220;Why are you using it?&#8221;, I asked. &#8221;<em>Uhhh&#8230; Hmmm&#8230;</em>&#8221;. <strong>Ding!</strong> A warning sign had popped in my head.</p>

<p>After a little questioning I found out that he searched for places in the code that were doing something similar and used that code too. He thought I was going to give him the usual &#8220;don&#8217;t copy and paste code&#8221; talk and said &#8220;Yeah, I know, code reuse! I&#8217;ll refactor it so I won&#8217;t need to copy it!&#8221; The problem was waaay beyond that.</p>

<p>The real problem is <strong>you should know what every line of your code does</strong>. That&#8217;s it. The interface he was using was totally irrelevant to the problem at hand, but because he saw it used he implemented it too. At first he didn&#8217;t get why it&#8217;s such a big deal. Only about 3 lines of code. I had to sit down with him and explain how hard it would be for someone else (or even himself a while from now) to try and understand and change that code. I&#8217;ve had the chance of seeing lines of code and asking myself &#8220;What the heck is this for?&#8221; That&#8217;s the worst thing that can happen to you. You now have voodoo code - can you delete it? Can you change it? Heck knows, especially if the test suite isn&#8217;t solid enough. And besides, a good programmer should be in control of what he&#8217;s doing and repeatedly ask himself &#8220;why?&#8221;. Why am I doing this? Why is this feature needed? Why am I catching this exception? Why why why. I think that&#8217;s probably the best way to leave great code behind.</p>

<p>So, that&#8217;s my point. Write what you understand, know what your code does.</p>

<p>Oh, and especially in cases like these - code review! See? Those are 2 lessons for the price of one.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2008/06/20/antlrv3-integration-with-eclipse/">ANTLRv3 Integration with Eclipse</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-06-20T13:49:15+03:00" pubdate data-updated="true">Jun 20<span>th</span>, 2008</time>
        
         | <a href="/2008/06/20/antlrv3-integration-with-eclipse/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I&#8217;ve been working on a pet project of mine, <a href="http://junit-converter.sf.net">junit-converter</a>, recently. It&#8217;s intended to help people migrate from JUnit 3 to JUnit 4, by adding required annotations and such, but it&#8217;s far from perfect. junit-converter is based on TestNG&#8217;s converter that uses Java&#8217;s Doclet.</p>

<p>For those who aren&#8217;t familiar with it, Doclet is something that allows you to process annotations added to javadoc comments and things like that, and it has some code-parsing capabilities that are being used in the TestNG converter.</p>

<p>Now, almost a year after publishing the first junit-converter version that&#8217;s based on the Doclet processing I&#8217;ve come to the decision that there has to be a better way for doing this. I&#8217;ve considered many options that I will write about some other time, but have finally come to the result that <a href="http://www.antlr.org">Antlr</a> seems like the best candidate out there.</p>

<p>I&#8217;ve been using it for a few weeks now and had some difficulties getting it to work pragmatically with eclipse. The main problem with antlr (and anything else that generates code automatically) is that eclipse isn&#8217;t aware of the changes and because of that doesn&#8217;t compile the right files etc&#8217;. At the beginning I used to manually run the antlr compiler after every change I&#8217;ve made to the grammar and then refresh the files that were generated in eclipse. This of course was really annoying.</p>

<p>Later, I created an ANT build.xml file that parses the grammar only when needed and ran it manually, which was a bit simpler, but still no winner there.</p>

<p>Then, at last, I came up with the most comfortable configuration so far. I&#8217;ve added to my project another builder (under build preferences), an ant builder. It used my build.xml file and I configured eclipse to build using it every time I save (just like it does with its builtin compiler). After making a few tweaks so it won&#8217;t compile unless needed it was pretty fast and not annoying (considering the grammar isn&#8217;t where the majority of the changes are anyway).</p>

<p>So, just in case someone else wants an already ready build.xml file for this purpose I&#8217;m attaching mine. Notice that I&#8217;m running antlr using the ant execute task as the built-in task in ant doesn&#8217;t support antlr 3 and I didn&#8217;t want to add another dependency to my code for the published task on antlr&#8217;s site.</p>

<p>I hope this helps someone, and if anyone has a better way of doing this I&#8217;d like to hear about it!</p>

<div><script src='https://gist.github.com/2182506.js?file='></script>
<noscript><pre><code>&lt;target name=&quot;compile&quot; depends=&quot;compile-grammar&quot;&gt;
    &lt;javac srcdir=&quot;${src}&quot; destdir=&quot;${build}&quot;&gt;
        &lt;classpath refid=&quot;classpath.base&quot;/&gt;
    &lt;/javac&gt;
&lt;/target&gt;

&lt;target name=&quot;compile-grammar&quot; depends=&quot;-check_grammar_needs_compile&quot;
        if=&quot;grammarBuildRequired&quot;&gt;
    &lt;java classname=&quot;org.antlr.Tool&quot; failonerror=&quot;true&quot;&gt;
        &lt;arg value=&quot;${grammar-file}&quot;/&gt;
        &lt;classpath refid=&quot;classpath.antlr&quot;/&gt;
    &lt;/java&gt;
&lt;/target&gt;

&lt;target name=&quot;-check_grammar_needs_compile&quot;&gt;
    &lt;uptodate property=&quot;grammarBuildRequired&quot; targetfile=&quot;${grammar-file}&quot;
        srcfile=&quot;${grammar-java-file}&quot;/&gt;
&lt;/target&gt;</code></pre></noscript></div>



</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2008/05/06/multiple-threads-testing-idioms-in-java/">Multiple Threads Testing Idioms In Java</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-05-06T22:26:18+03:00" pubdate data-updated="true">May 6<span>th</span>, 2008</time>
        
         | <a href="/2008/05/06/multiple-threads-testing-idioms-in-java/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Today I needed to make a few modification to one of our older Java applications. So, first thing&#8217;s first - I checked out the latest copy and ran the test suite. Surprisingly enough all the tests passed. But, something wasn&#8217;t right. I caught the glimpse of a stack trace flipping by in Eclipse&#8217;s console window. Scrolling up to it I found out an AssertionError was thrown. How come the tests passed?</p>

<p>A little digging revealed this (simplified) test case:</p>

<div><script src='https://gist.github.com/2182545.js?file=BuggyTest.java'></script>
<noscript><pre><code>public void buggieTest() throws Exception {
    // Do some setup
    // ...

    new Thread() {
        @Override
        public void run() {
            int x = 0;
            // Check a few things that change x
            // ...
            assertTrue(&quot;An error&quot;, x &gt; 3); // This fails!
        }
    }.start();

    // Wait for other thread
    Thread.sleep(2000);
}</code></pre></noscript></div>


<p>Can you spot the bug? The assertion fails, but in another thread. The test is testing an asynchronous module&#8217;s response. JUnit&#8217;s test executer isn&#8217;t aware of threads other than its own, so it thinks everything is OK. For the sake of the original developers I&#8217;ll mention the fact that they were using a home-built test runner that set ThreadGroups in order to catch those exceptions, but nowadays everyone use Eclipse&#8217;s JUnit plugin in my work place and that logic is no more.</p>

<p>So, what can we do? I first considered passing a boolean between the two threads so that the test&#8217;s thread would fail() if the other thread indicated failure. The problem is that the original error is either lost or hard to show.</p>

<p>After some thinking (and because I&#8217;m currently reading the great <a href="http://www.amazon.com/gp/product/0201310090?ie=UTF8&amp;tag=thcodu02-20&amp;linkCode=as2&amp;camp=1789&amp;creative=9325&amp;creativeASIN=0201310090">Concurrent Programming in Java</a><img src="http://www.assoc-amazon.com/e/ir?t=thcodu02-20&l=as2&o=1&a=0201310090" style="width: 0; height: 0; display: none; border: none !important;"> book) I came up with this simple solution using the JDK Exchanger class:</p>

<div><script src='https://gist.github.com/2182545.js?file=BetterTest.java'></script>
<noscript><pre><code>public void betterTest() throws Exception {
    // Do some setup
    // ...

    final Exchanger&lt;Exception&gt; exchanger = new Exchanger&lt;Exception&gt;();

    new Thread() {
        @Override
        public void run() {
            Exception thrown = null;
            try {
                int x = 0;
                // Check a few things that change x
                // ...
                assertTrue(&quot;An error&quot;, x &gt; 3); // This fails!
            } catch (Exception e) {
                thrown = e;
            }
            try {
                exchanger.exchange(thrown);
            } catch (InterruptedException ignored) {}
        }
    }.start();

    // Wait for other thread
    Exception exception = exchanger.exchange(null);
    if (exception != null) {
        throw exception;
    }
}</code></pre></noscript></div>


<p>So, what&#8217;s so better about this more complicated version? Well, first of all, it works. We use the exchanger to pass the exception to the testing thread. Another nice benefit is the fact we&#8217;re throwing the original exception - meaning that Eclipse&#8217;s plugin shows the right stack trace and clicking it gets you to the actual line that failed and not a simple fail() as opposed to the option I mentioned before.</p>

<p>Do you know of a better way to do this? I&#8217;m trying to think whether something can be added to JUnit for this purpose. Anyway, this results in a cool test that works great with the different plugins.</p>

<p>Happy testing!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2008/04/25/one-book-a-month/">One Book A Month</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-04-25T17:47:24+03:00" pubdate data-updated="true">Apr 25<span>th</span>, 2008</time>
        
         | <a href="/2008/04/25/one-book-a-month/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I&#8217;ve always loved books. I remember the vacation between 5th and 6th grades, my mother took me to the local library to get a subscription. I used to read 3 books a day during that vacation.</p>

<p>Later on, I still loved books, and used that to learn a lot about things I was interested in. As a mostly self taught coder, reading was the major way of learning new things.</p>

<p>Nowadays I keep reading as one of my most important hobbies. I read both technical books and &#8220;regular&#8221; books. My friends find it amusing to see me switching between Harry Potter and the Pragmatic Programmers.</p>

<p>For the past 2 years I&#8217;ve been keeping a king of book log. It started as a <em>to read</em> page on my laptop&#8217;s wiki since I always had so many to remember I want to read. Every book I finished I crossed from the list, sometimes even giving it a small review. Now, more than 2 years after starting this I did a little count of the numbers of book I&#8217;ve read.</p>

<p>Turns out my average is 2 books a month - one technical and one &#8220;regular&#8221;. That means over 50 books since I started that log. And you can be sure that&#8217;s the number one habit in helping me &#8220;up to it&#8221; in my industry. I&#8217;ve recently finished reading Chad Fowler&#8217;s &#8221;<a href="http://www.amazon.com/gp/product/0976694018?ie=UTF8&amp;tag=thcodu02-20&amp;linkCode=as2&amp;camp=1789&amp;creative=9325&amp;creativeASIN=0976694018">My Job Went to India</a><img src="http://www.assoc-amazon.com/e/ir?t=thcodu02-20&l=as2&o=1&a=0976694018" style="width: 0; height: 0; display: none; border: none !important;">&#8221; which made me realize that this is one of the <em>major edges</em> I have that differentiate me from your average Joe Programmer.</p>

<p>I can hear you saying &#8220;So he reads! Big deal!&#8221; Well, it <em>is</em> a big deal! I usually drop by my work place&#8217;s library every two days for a quick look - see if anything interesting pops up. This, overall, gives you an edge for a few reasons.</p>

<p>First of all, simply <em>looking</em> at your library is helpful. There is a great number of books I haven&#8217;t read there, but I know by title most of them, so whenever someone asks a question I don&#8217;t know the answer to I usually know where to point them (and, of course, that works for my own problems as well). Furthermore, every book you read usually mentions quite a lot more, and, like Google&#8217;s Page Rank, once I see a book referenced a few times I know it&#8217;s probably a good read and add it to my to-read list. See, good book-writers do social-networking in their books apparently and happen to appreciate other good book-writers.</p>

<p>Another advantage to reading, which is quite obvious, is that every book you read makes you smarter. Whenever I have to work with some new technology I try to get my hands on <em>The Book</em> for it (every topic has one, like Rubi&#8217;s <a href="http://www.amazon.com/gp/product/1934356085?ie=UTF8&amp;tag=thcodu02-20&amp;linkCode=as2&amp;camp=1789&amp;creative=9325&amp;creativeASIN=1934356085">PickAxe</a><img src="http://www.assoc-amazon.com/e/ir?t=thcodu02-20&l=as2&o=1&a=1934356085" style="width: 0; height: 0; display: none; border: none !important;">, C&#8217;s <a href="http://www.amazon.com/gp/product/0131103628?ie=UTF8&amp;tag=thcodu02-20&amp;linkCode=as2&amp;camp=1789&amp;creative=9325&amp;creativeASIN=0131103628">K&amp;R</a><img src="http://www.assoc-amazon.com/e/ir?t=thcodu02-20&l=as2&o=1&a=0131103628" style="width: 0; height: 0; display: none; border: none !important;">, the Gang of Four&#8217;s <a href="http://www.amazon.com/gp/product/0201633612?ie=UTF8&amp;tag=thcodu02-20&amp;linkCode=as2&amp;camp=1789&amp;creative=9325&amp;creativeASIN=0201633612">Design Patterns</a><img src="http://www.assoc-amazon.com/e/ir?t=thcodu02-20&l=as2&o=1&a=0201633612" style="width: 0; height: 0; display: none; border: none !important;"> book and so on). That of course makes me comfortable with the technology. But my work doesn&#8217;t require me to learn a new technology every month. What do I read in those oh so boring months? Well, usually, a random interesting-looking book from the library. Yes, even if it is about a technology no one uses in my workplace any more or about something that has absolutely nothing to do with your work that you wonder how it got to the library in the first place. Because, as I said earlier - <em>every</em> book you read makes you smarter. Reading books on other programming languages gives you another angle from which to look at your current favorite. About a year ago I read a book about <a href="http://http://en.wikipedia.org/wiki/Steganography">steganography</a> (hiding information inside other information. Take for example all those songs you play backwards to hear hidden messages). Why did I read it? I really don&#8217;t know. But a few months later it helped me quite a lot when I needed some background with error-correction algorithms which, prior to reading that book, I had none. If I haven&#8217;t read it, I wouldn&#8217;t even <em>know</em> I was in need of error-correction. That is one lucky coincidence, isn&#8217;t it? Well, it isn&#8217;t.</p>

<p>And, a final nice side effect of reading books is that it makes you a better writer. It&#8217;s like working with a guru, some of it is bound to stick to you (I hope my writing skills here don&#8217;t offend any of my favorite writers, eh?).</p>

<p>So try it. Keep a to-read list. Read a book a month.
I bet you will see it pays of quite quickly.</p>

<p>Have a nice weekend,</p>

<p>Aviv.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/page/7/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Aviv Ben-Yosef</h1>
  <img src="https://api.twitter.com/1/users/profile_image?screen_name=avivby&amp;size=original" width="128" height="128" style="height: 128px; width: 128px; border-radius: 6px">
  <p>An aspiring software craftsman and a happy hacker. More <a href="/about">about me</a>.</p>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2012/03/07/slides-from-the-how-billguard-does-mongodb-talk/">Slides from the &#8220;How BillGuard does MongoDB&#8221; Talk</a>
      </li>
    
      <li class="post">
        <a href="/2012/03/01/notes-from-the-agile-practitioners-2012-improving-your-tdd-workshop/">Notes from the Agile Practitioners 2012 Improving Your TDD Workshop</a>
      </li>
    
      <li class="post">
        <a href="/2012/02/28/notes-from-the-israeli-software-craftsmanship-group-code-retreat/">Notes from the Israeli Software Craftsmanship Group Code Retreat</a>
      </li>
    
      <li class="post">
        <a href="/2012/02/04/extend-your-toolbox-custom-matchers/">Extend Your Toolbox: Custom Matchers</a>
      </li>
    
      <li class="post">
        <a href="/2012/01/28/stop-bitching-do-self-agile/">Stop Bitching: Do Self-Agile</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("avivby", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/avivby" class="twitter-follow-button" data-show-count="false">Follow @avivby</a>
  
</section>


  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - Aviv Ben-Yosef -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'codelord';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
